# 10 1
# input_tokens = [62, 30, 15, 12, 758, 48, 17, 19, 52, 52]
# ttft_times = [0.035524768056347966, 0.047887549037113786, 0.03925755398813635, 0.04086203104816377, 0.11079526296816766, 0.04365393798798323, 0.04683444392867386, 0.030172156053595245, 0.04051426600199193, 0.04118810791987926]
# 斜率 a = 9.61767129516224e-05
# 截距 b = 0.03742618776965752
# 100 5
input_tokens = [62, 30, 15, 12, 758, 48, 17, 19, 52, 52, 103, 164, 33, 21, 9, 10, 37, 42, 17, 24, 15, 12, 23, 4, 4, 31, 23, 13, 206, 70, 36, 121, 10, 32, 4, 48, 18, 18, 12, 37, 13, 15, 97, 9, 26, 29, 150, 14, 10, 18, 10, 40, 23, 159, 45, 15, 71, 7, 21, 84, 31, 25, 39, 29, 16, 45, 17, 19, 22, 93, 7, 31, 40, 84, 14, 16, 59, 8, 50, 991, 19, 18, 278, 48, 14, 9, 135, 18, 18, 9, 75, 27, 12, 17, 9, 20, 31, 16, 21, 34]
ttft_times = [0.03508765599690378, 0.04565248207654804, 0.04525931191165, 0.04389362002257258, 0.1121779220411554, 0.04075333196669817, 0.04010438697878271, 0.03815852396655828, 0.048544203978963196, 0.04988787602633238, 0.05050187406595796, 0.05658634298015386, 0.040983189013786614, 0.04399318597279489, 0.047765028080902994, 0.04921717010438442, 0.04230494110379368, 0.037270860048010945, 0.045070371008478105, 0.030906368978321552, 0.02791557798627764, 0.031461460050195456, 0.03423842997290194, 0.04321753093972802, 0.056613054941408336, 0.03922117501497269, 0.04000349307898432, 0.048633028054609895, 0.05716641806066036, 0.03527957899495959, 0.05140371189918369, 0.03334896010346711, 0.04651695501524955, 0.04806768905837089, 0.04982387099880725, 0.045519768027588725, 0.03933654597494751, 0.03816159698180854, 0.051768698962405324, 0.04829990700818598, 0.05146306299138814, 0.04130781500134617, 0.05316023400519043, 0.047941389959305525, 0.03458602901082486, 0.04798586294054985, 0.044770779088139534, 0.04223356395959854, 0.05635586893185973, 0.045115837012417614, 0.03941922599915415, 0.04944857791997492, 0.04523221298586577, 0.053904507076367736, 0.04400317801628262, 0.04290653800126165, 0.04796139197424054, 0.04326862108428031, 0.049074016977101564, 0.06160223309416324, 0.054285863996483386, 0.05909307301044464, 0.04643463098909706, 0.04751717299222946, 0.0577577919466421, 0.05413365096319467, 0.053485192940570414, 0.05880950205028057, 0.04752114100847393, 0.060587155050598085, 0.04903434403240681, 0.0596130290068686, 0.04840992600657046, 0.05618773296009749, 0.05713325703982264, 0.047480223001912236, 0.05030092701781541, 0.058474772959016263, 0.043362481985241175, 0.1513816809747368, 0.12388785590883344, 0.056407700991258025, 0.0736847510561347, 0.07095452398061752, 0.06482264306396246, 0.04347526398487389, 0.050646762014366686, 0.05810460296925157, 0.04439050704240799, 0.05471669905818999, 0.05834238603711128, 0.05621088400948793, 0.0633252770639956, 0.04196482396218926, 0.053937216056510806, 0.05421106400899589, 0.060035329894162714, 0.059549898956902325, 0.055182878975756466, 0.042502361931838095]
# 斜率 a = 9.292406750589017e-05
# 截距 b = 0.04580511879558245
# 可以用线性回归或其他模型来拟合
from sklearn.linear_model import LinearRegression
import numpy as np

# reshape为二维数组
X = np.array(input_tokens).reshape(-1, 1)
y = np.array(ttft_times)

model = LinearRegression()
model.fit(X, y)

a = model.coef_[0]    # 获取斜率
b = model.intercept_  # 获取截距

print(f"斜率 a = {a}")
print(f"截距 b = {b}")